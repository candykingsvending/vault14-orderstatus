const API_KEY = "patKPNArV5RGmfXPz";
const BASE_ID = "appYsMTlnk2AAAQvB";
const TABLE_NAME = "Table_1";

async function trackOrder() {
    const orderId = document.getElementById("orderId").value;
    if (!orderId) {
        alert("Please enter an Order ID");
        return;
    }

    const url = `https://api.airtable.com/v0/${BASE_ID}/${TABLE_NAME}?filterByFormula={OrderID}='${orderId}'`;

    try {
        const response = await fetch(url, {
            headers: { Authorization: `Bearer ${API_KEY}` }
        });
        const data = await response.json();

        if (data.records.length === 0) {
            document.getElementById("statusMessage").innerText = "Order not found.";
            return;
        }

        const status = data.records[0].fields.Status;
        updateTracker(status);
    } catch (error) {
        console.error("Error fetching order:", error);
    }
}

function updateTracker(status) {
    const steps = {
        "Received": "step1",
        "Processing": "step2",
        "On The Way": "step3",
        "Delivered": "step4"
    };

    document.querySelectorAll(".step").forEach(step => step.classList.remove("active"));

    if (steps[status]) {
        document.getElementById(steps[status]).classList.add("active");
        document.getElementById("statusMessage").innerText = `Current Status: ${status}`;
    } else {
        document.getElementById("statusMessage").innerText = "Unknown status.";
    }
}
